# T079: SetHeader policy definition
name: setHeader
version: v1.0.0
description: |
  Sets, appends, or deletes HTTP headers on requests and responses.
  This policy supports three actions: SET (replace), APPEND (add), and DELETE (remove).

author: Policy Engine Team
license: MIT

# Header-only policy - does not require body access
requiresRequestBody: false
requiresResponseBody: false

# Policy can execute on both request and response phases
executionPhases:
  - request
  - response

parameters:
  - name: action
    type: string
    required: true
    description: |
      The action to perform on the header.
      Valid values: SET, APPEND, DELETE
    validation:
      enum:
        - SET
        - APPEND
        - DELETE

  - name: headerName
    type: string
    required: true
    description: |
      The name of the header to modify.
      Header names are case-insensitive.
    validation:
      minLength: 1
      maxLength: 256
      pattern: '^[a-zA-Z0-9-_]+$'

  - name: headerValue
    type: string
    required: false
    description: |
      The value to set or append to the header.
      Required for SET and APPEND actions, ignored for DELETE.
    validation:
      maxLength: 8192

examples:
  - name: Add custom header
    description: Adds X-Custom-Header with a fixed value
    config:
      action: SET
      headerName: x-custom-header
      headerValue: custom-value

  - name: Append to existing header
    description: Appends a value to an existing header
    config:
      action: APPEND
      headerName: x-forwarded-for
      headerValue: 192.168.1.1

  - name: Remove header
    description: Removes a header from request/response
    config:
      action: DELETE
      headerName: x-unwanted-header
