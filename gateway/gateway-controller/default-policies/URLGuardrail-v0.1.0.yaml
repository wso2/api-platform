name: URLGuardrail
version: v0.1.0
description: |
  Validates URLs found in request or response body content.
  Supports JSONPath extraction to validate specific fields within JSON payloads.
  Can validate URLs via DNS resolution only or HTTP HEAD request reachability.
  Supports separate configuration for request and response phases.

parameters:
  type: object
  properties:
    request:
      type: object
      description: Configuration for request phase validation
      properties:
        jsonPath:
          type: string
          description: |
            JSONPath expression to extract a specific value from JSON payload.
            If empty, validates the entire payload as a string.
            Examples: "$.message", "$.data.content", "$.items[0].text"
          default: ""
        onlyDNS:
          type: boolean
          description: |
            If true, validates URLs only via DNS resolution (faster, less reliable).
            If false (default), validates URLs via HTTP HEAD request (slower, more reliable).
          default: false
        timeout:
          type: integer
          description: |
            Timeout in milliseconds for DNS lookup or HTTP HEAD request.
            Default is 3000ms (3 seconds).
          default: 3000
        showAssessment:
          type: boolean
          description: |
            If true, includes detailed assessment information including invalid URLs in error responses.
            If false, returns minimal error information.
          default: false
    response:
      type: object
      description: Configuration for response phase validation
      properties:
        jsonPath:
          type: string
          description: |
            JSONPath expression to extract a specific value from JSON payload.
            If empty, validates the entire payload as a string.
            Examples: "$.message", "$.data.content", "$.items[0].text"
          default: ""
        onlyDNS:
          type: boolean
          description: |
            If true, validates URLs only via DNS resolution (faster, less reliable).
            If false (default), validates URLs via HTTP HEAD request (slower, more reliable).
          default: false
        timeout:
          type: integer
          description: |
            Timeout in milliseconds for DNS lookup or HTTP HEAD request.
            Default is 3000ms (3 seconds).
          default: 3000
        showAssessment:
          type: boolean
          description: |
            If true, includes detailed assessment information including invalid URLs in error responses.
            If false, returns minimal error information.
          default: false

systemParameters:
  type: object
  properties: {}
