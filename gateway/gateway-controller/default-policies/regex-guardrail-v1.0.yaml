name: RegexGuardrail
version: v1.0.0
description: |
  Validates request or response body content against a regular expression pattern.
  Supports JSONPath extraction to validate specific fields within JSON payloads.
  Can be configured to match or invert the regex pattern.
  Supports separate configuration for request and response phases.

parameters:
  - name: name
    type: string
    required: true
    description: Name of the guardrail policy for identification
    validation:
      minLength: 1
      maxLength: 256

  - name: request
    type: object
    required: false
    description: Configuration for request phase validation
    properties:
      - name: regex
        type: string
        required: true
        description: Regular expression pattern to match against the content
        validation:
          minLength: 1

      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, validates the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: invert
        type: boolean
        required: false
        default: false
        description: |
          If true, validation passes when regex does NOT match (inverted logic).
          If false (default), validation passes when regex matches.

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed assessment information in error responses.
          If false, returns minimal error information.

  - name: response
    type: object
    required: false
    description: Configuration for response phase validation
    properties:
      - name: regex
        type: string
        required: true
        description: Regular expression pattern to match against the content
        validation:
          minLength: 1

      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, validates the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: invert
        type: boolean
        required: false
        default: false
        description: |
          If true, validation passes when regex does NOT match (inverted logic).
          If false (default), validation passes when regex matches.

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed assessment information in error responses.
          If false, returns minimal error information.

