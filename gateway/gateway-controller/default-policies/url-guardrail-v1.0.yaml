name: URLGuardrail
version: v1.0.0
description: |
  Validates URLs found in request or response body content.
  Supports JSONPath extraction to validate specific fields within JSON payloads.
  Can validate URLs via DNS resolution only or HTTP HEAD request reachability.
  Supports separate configuration for request and response phases.

parameters:
  - name: request
    type: object
    required: false
    description: Configuration for request phase validation
    properties:
      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, validates the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: onlyDNS
        type: boolean
        required: false
        default: false
        description: |
          If true, validates URLs only via DNS resolution (faster, less reliable).
          If false (default), validates URLs via HTTP HEAD request (slower, more reliable).

      - name: timeout
        type: integer
        required: false
        default: 3000
        description: |
          Timeout in milliseconds for DNS lookup or HTTP HEAD request.
          Default is 3000ms (3 seconds).

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed assessment information including invalid URLs in error responses.
          If false, returns minimal error information.

  - name: response
    type: object
    required: false
    description: Configuration for response phase validation
    properties:
      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, validates the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: onlyDNS
        type: boolean
        required: false
        default: false
        description: |
          If true, validates URLs only via DNS resolution (faster, less reliable).
          If false (default), validates URLs via HTTP HEAD request (slower, more reliable).

      - name: timeout
        type: integer
        required: false
        default: 3000
        description: |
          Timeout in milliseconds for DNS lookup or HTTP HEAD request.
          Default is 3000ms (3 seconds).

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed assessment information including invalid URLs in error responses.
          If false, returns minimal error information.

