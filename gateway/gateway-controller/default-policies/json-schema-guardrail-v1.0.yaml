name: JSONSchemaGuardrail
version: v1.0.0
description: |
  Validates request or response body content against a JSON Schema.
  Supports JSONPath extraction to validate specific fields within JSON payloads.
  Can be configured with inverted logic to pass when schema validation fails.
  Supports separate configuration for request and response phases.

parameters:
  - name: name
    type: string
    required: true
    description: Name of the guardrail policy for identification
    validation:
      minLength: 1
      maxLength: 256

  - name: request
    type: object
    required: false
    description: Configuration for request phase validation
    properties:
      - name: schema
        type: string
        required: true
        description: |
          JSON Schema as a string (must be valid JSON).
          Supports all JSON Schema draft 7 features including types, properties, required fields, constraints, etc.
          Example: '{"type":"object","properties":{"name":{"type":"string"},"age":{"type":"integer","minimum":18}},"required":["name","age"]}'

      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload for validation.
          If empty, validates the entire payload against the schema.
          Examples: "$.data", "$.userInfo", "$.items[0]"

      - name: invert
        type: boolean
        required: false
        default: false
        description: |
          If true, validation passes when schema validation FAILS (inverted logic).
          If false (default), validation passes when schema validation succeeds.

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed validation error information in error responses.
          If false, returns minimal error information.

  - name: response
    type: object
    required: false
    description: Configuration for response phase validation
    properties:
      - name: schema
        type: string
        required: true
        description: |
          JSON Schema as a string (must be valid JSON).
          Supports all JSON Schema draft 7 features including types, properties, required fields, constraints, etc.
          Example: '{"type":"object","properties":{"name":{"type":"string"},"age":{"type":"integer","minimum":18}},"required":["name","age"]}'

      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload for validation.
          If empty, validates the entire payload against the schema.
          Examples: "$.data", "$.userInfo", "$.items[0]"

      - name: invert
        type: boolean
        required: false
        default: false
        description: |
          If true, validation passes when schema validation FAILS (inverted logic).
          If false (default), validation passes when schema validation succeeds.

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed validation error information in error responses.
          If false, returns minimal error information.

