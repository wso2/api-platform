name: AWSBedrockGuardrail
version: v1.0.0
description: |
  Validates request or response body content against AWS Bedrock Guardrails.
  Supports content filtering, topic detection, word filtering, and PII detection/masking.
  Supports three authentication modes: role-based (AssumeRole), static credentials, or default credential chain.
  Supports JSONPath extraction to validate specific fields within JSON payloads.
  Supports separate configuration for request and response phases.

parameters:
  - name: region
    type: string
    required: true
    description: AWS region where the Bedrock Guardrail is located (e.g., "us-east-1")
    validation:
      minLength: 1

  - name: guardrailID
    type: string
    required: true
    description: AWS Bedrock Guardrail identifier
    validation:
      minLength: 1

  - name: guardrailVersion
    type: string
    required: true
    description: AWS Bedrock Guardrail version (e.g., "DRAFT", "1")
    validation:
      minLength: 1

  - name: awsAccessKeyID
    type: string
    required: false
    description: AWS access key ID (for static credentials or role assumption)
    validation:
      minLength: 1

  - name: awsSecretAccessKey
    type: string
    required: false
    description: AWS secret access key (for static credentials or role assumption)
    validation:
      minLength: 1

  - name: awsSessionToken
    type: string
    required: false
    description: AWS session token (optional, for temporary credentials)
    validation:
      minLength: 1

  - name: awsRoleARN
    type: string
    required: false
    description: AWS IAM role ARN to assume (for role-based authentication)
    validation:
      minLength: 1

  - name: awsRoleRegion
    type: string
    required: false
    description: AWS region for role assumption (required if awsRoleARN is specified)
    validation:
      minLength: 1

  - name: awsRoleExternalID
    type: string
    required: false
    description: External ID for role assumption (optional)
    validation:
      minLength: 1

  - name: request
    type: object
    required: false
    description: Configuration for request phase validation
    properties:
      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, validates the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: redactPII
        type: boolean
        required: false
        default: false
        description: |
          If true, redacts PII by replacing with "*****" (permanent, cannot be restored).
          If false (default), masks PII with placeholders that can be restored in responses.

      - name: passthroughOnError
        type: boolean
        required: false
        default: false
        description: |
          If true, allows requests to proceed if AWS Bedrock Guardrail API call fails.
          If false (default), blocks requests on API errors.

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed assessment information from AWS Bedrock Guardrail in error responses.
          If false, returns minimal error information.

  - name: response
    type: object
    required: false
    description: Configuration for response phase validation
    properties:
      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, validates the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: redactPII
        type: boolean
        required: false
        default: false
        description: |
          If true, redacts PII by replacing with "*****" (permanent, cannot be restored).
          If false (default), restores masked PII from request phase.

      - name: passthroughOnError
        type: boolean
        required: false
        default: false
        description: |
          If true, allows requests to proceed if AWS Bedrock Guardrail API call fails.
          If false (default), blocks requests on API errors.

      - name: showAssessment
        type: boolean
        required: false
        default: false
        description: |
          If true, includes detailed assessment information from AWS Bedrock Guardrail in error responses.
          If false, returns minimal error information.

