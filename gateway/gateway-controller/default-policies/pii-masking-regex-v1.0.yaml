name: PIIMaskingRegex
version: v1.0.0
description: |
  Masks or redacts Personally Identifiable Information (PII) from request/response bodies using regex patterns.
  Supports two modes: masking (replaces with placeholders that can be restored in responses) and redaction (replaces with *****).
  When masking mode is used, PII is masked in requests and automatically restored in responses.
  Supports separate configuration for request and response phases.

parameters:
  - name: request
    type: object
    required: false
    description: Configuration for request phase PII masking
    properties:
      - name: piiEntities
        type: array
        required: true
        description: |
          Array of PII entity configurations, each containing:
          - piiEntity: Name/type of the PII entity (e.g., "EMAIL", "PHONE", "SSN")
          - piiRegex: Regular expression pattern to match the PII entity
        items:
          type: object
          properties:
            - name: piiEntity
              type: string
              required: true
              description: Name/type of the PII entity
            - name: piiRegex
              type: string
              required: true
              description: Regular expression pattern to match the PII entity

      - name: jsonPath
        type: string
        required: false
        default: ""
        description: |
          JSONPath expression to extract a specific value from JSON payload.
          If empty, processes the entire payload as a string.
          Examples: "$.message", "$.data.content", "$.items[0].text"

      - name: redactPII
        type: boolean
        required: false
        default: false
        description: |
          If true, redacts PII by replacing with "*****" (permanent, cannot be restored).
          If false (default), masks PII with placeholders that can be restored in responses.

  - name: response
    type: object
    required: false
    description: Configuration for response phase PII restoration (only used when redactPII is false)
    properties:
      - name: redactPII
        type: boolean
        required: false
        default: false
        description: |
          If true, no restoration is performed (PII was permanently redacted).
          If false (default), restores masked PII from request phase.

