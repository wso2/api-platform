name: CountLetters
version: v1.0.0
description: |
  Analyzes the response body and counts occurrences of specified letters/characters.
  Replaces the response body with the letter count results in JSON or text format.
  Useful for analytics, debugging, and content analysis.

# Policy execution phases
supportsRequestPhase: false
supportsResponsePhase: true

# Body access requirements - requires response body for analysis
requiresRequestBody: false
requiresResponseBody: true

parameters:
  - name: letters
    type: array
    required: true
    description: |
      Array of letters/characters to count in the response body.
      Each element should be a string (can be single character or multi-character string).
    items:
      type: string
      validation:
        minLength: 1

  - name: caseSensitive
    type: boolean
    required: false
    default: false
    description: |
      Whether letter counting should be case-sensitive.
      If false (default), 'A' and 'a' are treated as the same letter.

  - name: outputFormat
    type: string
    required: false
    default: "json"
    description: |
      Output format for the letter counts.
      Valid values: "json" or "text"
    validation:
      enum:
        - json
        - text

examples:
  - name: Count vowels in JSON format
    description: Counts occurrences of vowels and returns JSON
    config:
      letters: ["a", "e", "i", "o", "u"]
      caseSensitive: false
      outputFormat: json
    output: |
      {
        "letterCounts": {
          "a": 42,
          "e": 38,
          "i": 25,
          "o": 19,
          "u": 12
        }
      }

  - name: Count specific characters case-sensitively
    description: Counts uppercase and lowercase letters separately
    config:
      letters: ["A", "a", "B", "b"]
      caseSensitive: true
      outputFormat: json

  - name: Count words or patterns
    description: Counts multi-character strings in the response
    config:
      letters: ["hello", "world", "error"]
      caseSensitive: false
      outputFormat: text
    output: |
      Letter Counts:
      hello: 3
      world: 2
      error: 0

  - name: Count special characters
    description: Counts special characters in the response
    config:
      letters: ["@", "#", "$", "!"]
      caseSensitive: true
      outputFormat: json
