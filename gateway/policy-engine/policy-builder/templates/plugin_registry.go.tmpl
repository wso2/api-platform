// Code generated by Policy Engine Builder. DO NOT EDIT.
package main

import (
	"log/slog"

	"github.com/policy-engine/policy-engine/internal/registry"
	"github.com/policy-engine/sdk/policy"
{{- range .Policies }}
	{{ .ImportAlias }} "{{ .ImportPath }}"
{{- end }}
)

func init() {
	slog.Info("Registering policies from Builder compilation")

	{{- range .Policies }}
	// Register {{ .Name }} {{ .Version }}
	policyDef_{{ .ImportAlias }} := &policy.PolicyDefinition{
		Name:    "{{ .Name }}",
		Version: "{{ .Version }}",
	}
	if err := registry.GetRegistry().Register(policyDef_{{ .ImportAlias }}, {{ .ImportAlias }}.NewPolicy()); err != nil {
		slog.Error("Failed to register policy", "policy", "{{ .Name }}", "version", "{{ .Version }}", "error", err)
	} else {
		slog.Info("Registered policy", "policy", "{{ .Name }}", "version", "{{ .Version }}")
	}
	{{- end }}
}
