
[analytics]
enabled = false

[analytics.publishers.settings]
application_id = "<MOESIF_APPLICATION_ID>"

[gateway_controller.router]
gateway_host = "*"

[gateway_controller.router.access_logs]
enabled = true

[gateway_controller.auth.basic]
enabled = true

[[gateway_controller.auth.basic.users]]
username = "admin"
password = "admin"
roles = ["admin"]

# Remove policy_configurations once the issue is resolved: https://github.com/wso2/api-platform/issues/564
[policy_configurations.ratelimit_v010]
algorithm = "fixed-window"
backend = "memory"

[policy_configurations.ratelimit_v010.memory]
max_entries = 10000
cleanup_interval = "5m"

[policy_configurations.ratelimit_v010.headers]
include_x_rate_limit = true
include_ietf = true
include_retry_after = true

# =============================================================================
# ANALYTICS CONFIGURATION
# =============================================================================

[analytics]
enabled = false
allow_payloads = false

[[analytics.publishers]]
type = "moesif"
enabled = true

[analytics.publishers.settings]
application_id = "<MOESIF_APPLICATION_ID>"
moesif_base_url = "https://api.moesif.net"
publish_interval = 5
event_queue_size = 10000
batch_size = 50
timer_wakeup_seconds = 3

[analytics.grpc_access_logs]
host = "policy-engine"
log_name = "envoy_access_log"
buffer_flush_interval = 1000000000
buffer_size_bytes = 16384
grpc_request_timeout = 20000000000

[analytics.access_logs_service]
als_server_port = 18090
shutdown_timeout = "600s"
public_key_path = ""
private_key_path = ""
als_plain_text = true
max_message_size = 1000000000
max_header_limit = 8192

# =============================================================================
# TRACING CONFIGURATION
# =============================================================================

[tracing]
enabled = false
endpoint = "otel-collector:4317"
insecure = true
service_version = "1.0.0"
batch_timeout = "1s"
max_export_batch_size = 512
sampling_rate = 1.0
