// Code generated by Policy Engine Builder. DO NOT EDIT.
package main

import (
	"log/slog"

	"github.com/envoy-policy-engine/sdk/core"
{{- range .Policies }}
	{{ .ImportAlias }} "{{ .ImportPath }}"
{{- end }}
)

func init() {
	slog.Info("Registering policies from Builder compilation")

	{{- range .Policies }}
	// Register {{ .Name }} v{{ .Version }}
	if err := core.GetRegistry().RegisterImplementation("{{ .Name }}", "{{ .Version }}", {{ .ImportAlias }}.NewPolicy()); err != nil {
		slog.Error("Failed to register policy", "policy", "{{ .Name }}", "version", "{{ .Version }}", "error", err)
	} else {
		slog.Info("Registered policy", "policy", "{{ .Name }}", "version", "{{ .Version }}")
	}
	{{- end }}
}
